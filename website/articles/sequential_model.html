<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Sequential model • keras</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="The Sequential model">
<meta property="og:description" content="Complete guide to the Sequential model.">
<meta property="og:image" content="https://keras.posit.co/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">keras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.13.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_classification.html">Basic Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_text_classification.html">Text Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_regression.html">Basic Regression</a>
    </li>
    <li>
      <a href="../articles/tutorial_overfit_underfit.html">Overfitting and Underfitting</a>
    </li>
    <li>
      <a href="../articles/tutorial_save_and_restore.html">Save and Restore Models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Guides (New for TF 2.6)</li>
    <li>
      <a href="../articles/new-guides/python_subclasses.html">Python Subclasses</a>
    </li>
    <li>
      <a href="../articles/new-guides/making_new_layers_and_models_via_subclassing.html">Making New Layers and Models via Subclassing</a>
    </li>
    <li>
      <a href="../articles/new-guides/customizing_what_happens_in_fit.html">Customizing What Happens in Fit</a>
    </li>
    <li>
      <a href="../articles/new-guides/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    </li>
    <li>
      <a href="../articles/new-guides/preprocessing_layers.html">Working with Preprocessing Layers</a>
    </li>
    <li>
      <a href="../argicles/new-guides/working_with_rnns.html">Working with RNNs</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Using Keras</li>
    <li>
      <a href="../articles/guide_keras.html">Guide to Keras Basics</a>
    </li>
    <li>
      <a href="../articles/sequential_model.html">Sequential Model in Depth</a>
    </li>
    <li>
      <a href="../articles/functional_api.html">Functional API in Depth</a>
    </li>
    <li>
      <a href="../articles/about_keras_models.html">About Keras Models</a>
    </li>
    <li>
      <a href="../articles/about_keras_layers.html">About Keras Layers</a>
    </li>
    <li>
      <a href="../articles/training_visualization.html">Training Visualization</a>
    </li>
    <li>
      <a href="../articles/applications.html">Pre-Trained Models</a>
    </li>
    <li>
      <a href="../articles/faq.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/why_use_keras.html">Why Use Keras?</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/eager_guide.html">Eager Execution</a>
    </li>
    <li>
      <a href="../articles/training_callbacks.html">Training Callbacks</a>
    </li>
    <li>
      <a href="../articles/backend.html">Keras Backend</a>
    </li>
    <li>
      <a href="../articles/custom_layers.html">Custom Layers</a>
    </li>
    <li>
      <a href="../articles/custom_models.html">Custom Models</a>
    </li>
    <li>
      <a href="../articles/saving_serializing.html">Saving and serializing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/learn.html">Learn</a>
</li>
<li>
  <a href="../articles/tools.html">Tools</a>
</li>
<li>
  <a href="../articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/keras/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Sequential model</h1>
                        <h4 data-toc-skip class="author"><a href="https://twitter.com/fchollet" class="external-link">fchollet</a></h4>
            
            <h4 data-toc-skip class="date">Last Modified: 2023-11-10;
Last Rendered: 2023-11-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/keras/blob/HEAD/vignettes/sequential_model.Rmd" class="external-link"><code>vignettes/sequential_model.Rmd</code></a></small>
      <div class="hidden name"><code>sequential_model.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> keras</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> layers</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> ops</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="when-to-use-a-sequential-model">When to use a Sequential model<a class="anchor" aria-label="anchor" href="#when-to-use-a-sequential-model"></a>
</h2>
<p>A <code>Sequential</code> model is appropriate for <strong>a plain
stack of layers</strong> where each layer has <strong>exactly one input
tensor and one output tensor</strong>.</p>
<p>Schematically, the following <code>Sequential</code> model:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Define Sequential model with 3 layers</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    [</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>        layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"layer1"</span>),</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>        layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"layer2"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>        layers.Dense(<span class="dv">4</span>, name<span class="op">=</span><span class="st">"layer3"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    ]</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># Call model on a test input</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>x <span class="op">=</span> ops.ones((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>y <span class="op">=</span> model(x)</span></code></pre></div>
<p>is equivalent to this function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Create 3 layers</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>layer1 <span class="op">=</span> layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"layer1"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>layer2 <span class="op">=</span> layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"layer2"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>layer3 <span class="op">=</span> layers.Dense(<span class="dv">4</span>, name<span class="op">=</span><span class="st">"layer3"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># Call layers on a test input</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>x <span class="op">=</span> ops.ones((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>y <span class="op">=</span> layer3(layer2(layer1(x)))</span></code></pre></div>
<p>A Sequential model is <strong>not appropriate</strong> when:</p>
<ul>
<li>Your model has multiple inputs or multiple outputs</li>
<li>Any of your layers has multiple inputs or multiple outputs</li>
<li>You need to do layer sharing</li>
<li>You want non-linear topology (e.g. a residual connection, a
multi-branch model)</li>
</ul>
</div>
<div class="section level2">
<h2 id="creating-a-sequential-model">Creating a Sequential model<a class="anchor" aria-label="anchor" href="#creating-a-sequential-model"></a>
</h2>
<p>You can create a Sequential model by passing a list of layers to the
Sequential constructor:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    [</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>        layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>        layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>        layers.Dense(<span class="dv">4</span>),</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    ]</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Its layers are accessible via the <code>layers</code> attribute:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>model.layers</span></code></pre></div>
<p>You can also create a Sequential model incrementally via the
<code>add()</code> method:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">4</span>))</span></code></pre></div>
<p>Note that there’s also a corresponding <code>pop()</code> method to
remove layers: a Sequential model behaves very much like a list of
layers.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>model.pop()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(model.layers))  <span class="co"># 2</span></span></code></pre></div>
<p>Also note that the Sequential constructor accepts a <code>name</code>
argument, just like any layer or model in Keras. This is useful to
annotate TensorBoard graphs with semantically meaningful names.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential(name<span class="op">=</span><span class="st">"my_sequential"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"layer1"</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"layer2"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">4</span>, name<span class="op">=</span><span class="st">"layer3"</span>))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifying-the-input-shape-in-advance">Specifying the input shape in advance<a class="anchor" aria-label="anchor" href="#specifying-the-input-shape-in-advance"></a>
</h2>
<p>Generally, all layers in Keras need to know the shape of their inputs
in order to be able to create their weights. So when you create a layer
like this, initially, it has no weights:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>layer <span class="op">=</span> layers.Dense(<span class="dv">3</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>layer.weights  <span class="co"># Empty</span></span></code></pre></div>
<p>It creates its weights the first time it is called on an input, since
the shape of the weights depends on the shape of the inputs:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Call layer on a test input</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>x <span class="op">=</span> ops.ones((<span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>y <span class="op">=</span> layer(x)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>layer.weights  <span class="co"># Now it has weights, of shape (4, 3) and (3,)</span></span></code></pre></div>
<p>Naturally, this also applies to Sequential models. When you
instantiate a Sequential model without an input shape, it isn’t “built”:
it has no weights (and calling <code>model.weights</code> results in an
error stating just this). The weights are created when the model first
sees some input data:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    [</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>        layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>        layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>        layers.Dense(<span class="dv">4</span>),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    ]</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>)  <span class="co"># No weights at this stage!</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co"># At this point, you can't do this:</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co"># model.weights</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># You also can't do this:</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co"># model.summary()</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co"># Call the model on a test input</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>x <span class="op">=</span> ops.ones((<span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>y <span class="op">=</span> model(x)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of weights after calling the model:"</span>, <span class="bu">len</span>(model.weights))  <span class="co"># 6</span></span></code></pre></div>
<p>Once a model is “built”, you can call its <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
method to display its contents:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>model.summary()</span></code></pre></div>
<p>However, it can be very useful when building a Sequential model
incrementally to be able to display the summary of the model so far,
including the current output shape. In this case, you should start your
model by passing an <code>Input</code> object to your model, so that it
knows its input shape from the start:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential()</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>model.add(keras.Input(shape<span class="op">=</span>(<span class="dv">4</span>,)))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>model.summary()</span></code></pre></div>
<p>Note that the <code>Input</code> object is not displayed as part of
<code>model.layers</code>, since it isn’t a layer:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>model.layers</span></code></pre></div>
<p>Models built with a predefined input shape like this always have
weights (even before seeing any data) and always have a defined output
shape.</p>
<p>In general, it’s a recommended best practice to always specify the
input shape of a Sequential model in advance if you know what it is.</p>
</div>
<div class="section level2">
<h2 id="a-common-debugging-workflow-add-summary">A common debugging workflow: <code>add()</code> +
<code>summary()</code><a class="anchor" aria-label="anchor" href="#a-common-debugging-workflow-add-summary"></a>
</h2>
<p>When building a new Sequential architecture, it’s useful to
incrementally stack layers with <code>add()</code> and frequently print
model summaries. For instance, this enables you to monitor how a stack
of <code>Conv2D</code> and <code>MaxPooling2D</code> layers is
downsampling image feature maps:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential()</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>model.add(keras.Input(shape<span class="op">=</span>(<span class="dv">250</span>, <span class="dv">250</span>, <span class="dv">3</span>)))  <span class="co"># 250x250 RGB images</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, <span class="dv">5</span>, strides<span class="op">=</span><span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>model.add(layers.MaxPooling2D(<span class="dv">3</span>))</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># Can you guess what the current output shape is at this point? Probably not.</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co"># Let's just print it:</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>model.summary()</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co"># The answer was: (40, 40, 32), so we can keep downsampling...</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>model.add(layers.MaxPooling2D(<span class="dv">3</span>))</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>))</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>model.add(layers.MaxPooling2D(<span class="dv">2</span>))</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co"># And now?</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>model.summary()</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co"># Now that we have 4x4 feature maps, time to apply global max pooling.</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>model.add(layers.GlobalMaxPooling2D())</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co"># Finally, we add a classification layer.</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">10</span>))</span></code></pre></div>
<p>Very practical, right?</p>
</div>
<div class="section level2">
<h2 id="what-to-do-once-you-have-a-model">What to do once you have a model<a class="anchor" aria-label="anchor" href="#what-to-do-once-you-have-a-model"></a>
</h2>
<p>Once your model architecture is ready, you will want to:</p>
<ul>
<li>Train your model, evaluate it, and run inference. See our <a href="/guides/training_with_built_in_methods/">guide to training &amp;
evaluation with the built-in loops</a>
</li>
<li>Save your model to disk and restore it. See our <a href="/guides/serialization_and_saving/">guide to serialization &amp;
saving</a>.</li>
<li>Speed up model training by leveraging multiple GPUs. See our <a href="https://keras.io/guides/distributed_training/" class="external-link">guide to multi-GPU
and distributed training</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="feature-extraction-with-a-sequential-model">Feature extraction with a Sequential model<a class="anchor" aria-label="anchor" href="#feature-extraction-with-a-sequential-model"></a>
</h2>
<p>Once a Sequential model has been built, it behaves like a <a href="/guides/functional_api/">Functional API model</a>. This means that
every layer has an <code>input</code> and <code>output</code> attribute.
These attributes can be used to do neat things, like quickly creating a
model that extracts the outputs of all intermediate layers in a
Sequential model:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>initial_model <span class="op">=</span> keras.Sequential(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>    [</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>        keras.Input(shape<span class="op">=</span>(<span class="dv">250</span>, <span class="dv">250</span>, <span class="dv">3</span>)),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>        layers.Conv2D(<span class="dv">32</span>, <span class="dv">5</span>, strides<span class="op">=</span><span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>        layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>        layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    ]</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>feature_extractor <span class="op">=</span> keras.Model(</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    inputs<span class="op">=</span>initial_model.inputs,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>    outputs<span class="op">=</span>[layer.output <span class="cf">for</span> layer <span class="kw">in</span> initial_model.layers],</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co"># Call feature extractor on test input.</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>x <span class="op">=</span> ops.ones((<span class="dv">1</span>, <span class="dv">250</span>, <span class="dv">250</span>, <span class="dv">3</span>))</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>features <span class="op">=</span> feature_extractor(x)</span></code></pre></div>
<p>Here’s a similar example that only extract features from one
layer:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>initial_model <span class="op">=</span> keras.Sequential(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    [</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>        keras.Input(shape<span class="op">=</span>(<span class="dv">250</span>, <span class="dv">250</span>, <span class="dv">3</span>)),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>        layers.Conv2D(<span class="dv">32</span>, <span class="dv">5</span>, strides<span class="op">=</span><span class="dv">2</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>        layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"my_intermediate_layer"</span>),</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>        layers.Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    ]</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>feature_extractor <span class="op">=</span> keras.Model(</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    inputs<span class="op">=</span>initial_model.inputs,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>    outputs<span class="op">=</span>initial_model.get_layer(name<span class="op">=</span><span class="st">"my_intermediate_layer"</span>).output,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co"># Call feature extractor on test input.</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>x <span class="op">=</span> ops.ones((<span class="dv">1</span>, <span class="dv">250</span>, <span class="dv">250</span>, <span class="dv">3</span>))</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>features <span class="op">=</span> feature_extractor(x)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transfer-learning-with-a-sequential-model">Transfer learning with a Sequential model<a class="anchor" aria-label="anchor" href="#transfer-learning-with-a-sequential-model"></a>
</h2>
<p>Transfer learning consists of freezing the bottom layers in a model
and only training the top layers. If you aren’t familiar with it, make
sure to read our <a href="/guides/transfer_learning/">guide to transfer
learning</a>.</p>
<p>Here are two common transfer learning blueprint involving Sequential
models.</p>
<p>First, let’s say that you have a Sequential model, and you want to
freeze all layers except the last one. In this case, you would simply
iterate over <code>model.layers</code> and set
<code>layer.trainable = False</code> on each layer, except the last one.
Like this:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential([</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>    keras.Input(shape<span class="op">=</span>(<span class="dv">784</span>)),</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    layers.Dense(<span class="dv">10</span>),</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>])</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># Presumably you would want to first load pre-trained weights.</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>model.load_weights(...)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># Freeze all layers except the last one.</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="cf">for</span> layer <span class="kw">in</span> model.layers[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  layer.trainable <span class="op">=</span> <span class="va">False</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co"># Recompile and train (this will only update the weights of the last layer).</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>model.<span class="bu">compile</span>(...)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>model.fit(...)</span></code></pre></div>
<p>Another common blueprint is to use a Sequential model to stack a
pre-trained model and some freshly initialized classification layers.
Like this:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Load a convolutional base with pre-trained weights</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>base_model <span class="op">=</span> keras.applications.Xception(</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>    weights<span class="op">=</span><span class="st">'imagenet'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    include_top<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    pooling<span class="op">=</span><span class="st">'avg'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># Freeze the base model</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>base_model.trainable <span class="op">=</span> <span class="va">False</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># Use a Sequential model to add a trainable classifier on top</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential([</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>    base_model,</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>    layers.Dense(<span class="dv">1000</span>),</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>])</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co"># Compile &amp; train</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>model.<span class="bu">compile</span>(...)</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>model.fit(...)</span></code></pre></div>
<p>If you do transfer learning, you will probably find yourself
frequently using these two patterns.</p>
<p>That’s about all you need to know about Sequential models!</p>
<p>To find out more about building models in Keras, see:</p>
<ul>
<li><a href="/guides/functional_api/">Guide to the Functional
API</a></li>
<li><a href="/guides/making_new_layers_and_models_via_subclassing/">Guide to
making new Layers &amp; Models via subclassing</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, RStudio, Google.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
