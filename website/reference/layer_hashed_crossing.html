<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A preprocessing layer which crosses features using the "hashing trick". — layer_hashed_crossing • keras</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="A preprocessing layer which crosses features using the " hashing trick layer_hashed_crossing><meta property="og:description" content="This layer performs crosses of categorical features using the &quot;hashing
trick&quot;. Conceptually, the transformation can be thought of as:
`hash(concatenate(features)) % num_bins.
This layer currently only performs crosses of scalar inputs and batches of
scalar inputs. Valid input shapes are (batch_size, 1), (batch_size,) and
().
Note: This layer wraps tf.keras.layers.HashedCrossing. It cannot
be used as part of the compiled computation graph of a model with
any backend other than TensorFlow.
It can however be used with any backend when running eagerly.
It can also always be used as part of an input preprocessing pipeline
with any backend (outside the model itself), which is how we recommend
to use this layer.
Note: This layer is safe to use inside a tf.data pipeline
(independently of which backend you're using)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">keras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.13.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_classification.html">Basic Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_text_classification.html">Text Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_regression.html">Basic Regression</a>
    </li>
    <li>
      <a href="../articles/tutorial_overfit_underfit.html">Overfitting and Underfitting</a>
    </li>
    <li>
      <a href="../articles/tutorial_save_and_restore.html">Save and Restore Models</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Guides (New for TF 2.6)</li>
    <li>
      <a href="../articles/new-guides/python_subclasses.html">Python Subclasses</a>
    </li>
    <li>
      <a href="../articles/new-guides/making_new_layers_and_models_via_subclassing.html">Making New Layers and Models via Subclassing</a>
    </li>
    <li>
      <a href="../articles/new-guides/customizing_what_happens_in_fit.html">Customizing What Happens in Fit</a>
    </li>
    <li>
      <a href="../articles/new-guides/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    </li>
    <li>
      <a href="../articles/new-guides/preprocessing_layers.html">Working with Preprocessing Layers</a>
    </li>
    <li>
      <a href="../argicles/new-guides/working_with_rnns.html">Working with RNNs</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Using Keras</li>
    <li>
      <a href="../articles/guide_keras.html">Guide to Keras Basics</a>
    </li>
    <li>
      <a href="../articles/sequential_model.html">Sequential Model in Depth</a>
    </li>
    <li>
      <a href="../articles/functional_api.html">Functional API in Depth</a>
    </li>
    <li>
      <a href="../articles/about_keras_models.html">About Keras Models</a>
    </li>
    <li>
      <a href="../articles/about_keras_layers.html">About Keras Layers</a>
    </li>
    <li>
      <a href="../articles/training_visualization.html">Training Visualization</a>
    </li>
    <li>
      <a href="../articles/applications.html">Pre-Trained Models</a>
    </li>
    <li>
      <a href="../articles/faq.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/why_use_keras.html">Why Use Keras?</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/eager_guide.html">Eager Execution</a>
    </li>
    <li>
      <a href="../articles/training_callbacks.html">Training Callbacks</a>
    </li>
    <li>
      <a href="../articles/backend.html">Keras Backend</a>
    </li>
    <li>
      <a href="../articles/custom_layers.html">Custom Layers</a>
    </li>
    <li>
      <a href="../articles/custom_models.html">Custom Models</a>
    </li>
    <li>
      <a href="../articles/saving_serializing.html">Saving and serializing</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/learn.html">Learn</a>
</li>
<li>
  <a href="../articles/tools.html">Tools</a>
</li>
<li>
  <a href="../articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rstudio/keras/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A preprocessing layer which crosses features using the "hashing trick".</h1>
    <small class="dont-index">Source: <a href="https://github.com/rstudio/keras/blob/HEAD/R/autogen-layers-preprocessing.R" class="external-link"><code>R/autogen-layers-preprocessing.R</code></a></small>
    <div class="hidden name"><code>layer_hashed_crossing.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This layer performs crosses of categorical features using the "hashing
trick". Conceptually, the transformation can be thought of as:
`hash(concatenate(features)) % num_bins.</p>
<p>This layer currently only performs crosses of scalar inputs and batches of
scalar inputs. Valid input shapes are <code>(batch_size, 1)</code>, <code>(batch_size,)</code> and
<code>()</code>.</p>
<p><strong>Note:</strong> This layer wraps <code>tf.keras.layers.HashedCrossing</code>. It cannot
be used as part of the compiled computation graph of a model with
any backend other than TensorFlow.
It can however be used with any backend when running eagerly.
It can also always be used as part of an input preprocessing pipeline
with any backend (outside the model itself), which is how we recommend
to use this layer.</p>
<p><strong>Note:</strong> This layer is safe to use inside a <code>tf.data</code> pipeline
(independently of which backend you're using).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">layer_hashed_crossing</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">num_bins</span>,</span>
<span>  output_mode <span class="op">=</span> <span class="st">"int"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dtype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Object to compose the layer with. A tensor, array, or sequential model.</p></dd>


<dt>num_bins</dt>
<dd><p>Number of hash bins.</p></dd>


<dt>output_mode</dt>
<dd><p>Specification for the output of the layer. Values can be
<code>"int"</code>, or <code>"one_hot"</code> configuring the layer as follows:
- <code>"int"</code>: Return the integer bin indices directly.
- <code>"one_hot"</code>: Encodes each individual element in the input into an
array the same size as <code>num_bins</code>, containing a 1 at the input's
bin index. Defaults to <code>"int"</code>.</p></dd>


<dt>sparse</dt>
<dd><p>Boolean. Only applicable to <code>"one_hot"</code> mode and only valid
when using the TensorFlow backend. If <code>True</code>, returns
a <code>SparseTensor</code> instead of a dense <code>Tensor</code>. Defaults to <code>False</code>.</p></dd>


<dt>name</dt>
<dd><p>String, name for the object</p></dd>


<dt>dtype</dt>
<dd><p>datatype (e.g., <code>"float32"</code>).</p></dd>


<dt>...</dt>
<dd><p>Keyword arguments to construct a layer.</p></dd>

</dl></div>
    <div id="examples">
    <h2>Examples</h2>
    <p><strong>Crossing two scalar features.</strong></p>
<p></p><div class="sourceCode python"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>layer <span class="op">=</span> keras.layers.HashedCrossing(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    num_bins<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>feat1 <span class="op">=</span> np.array([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>])</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>feat2 <span class="op">=</span> np.array([<span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">102</span>])</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>layer((feat1, feat2))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># array([1, 4, 1, 1, 3])</span></span></code></pre><p></p></div>
<p><strong>Crossing and one-hotting two scalar features.</strong></p>
<p></p><div class="sourceCode python"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>layer <span class="op">=</span> keras.layers.HashedCrossing(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    num_bins<span class="op">=</span><span class="dv">5</span>, output_mode<span class="op">=</span><span class="st">'one_hot'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>feat1 <span class="op">=</span> np.array([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>])</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>feat2 <span class="op">=</span> np.array([<span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">102</span>])</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>layer((feat1, feat2))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># array([[0., 1., 0., 0., 0.],</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#         [0., 0., 0., 0., 1.],</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#         [0., 1., 0., 0., 0.],</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#         [0., 1., 0., 0., 0.],</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#         [0., 0., 0., 1., 0.]], dtype=float32)</span></span></code></pre><p></p></div>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><a href="https:/keras.io/api/layers/preprocessing_layers/categorical/hashed_crossing#hashedcrossing-class">https:/keras.io/api/layers/preprocessing_layers/categorical/hashed_crossing#hashedcrossing-class</a></p></li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/HashedCrossing" class="external-link">https://www.tensorflow.org/api_docs/python/tf/keras/layers/HashedCrossing</a></p></li>
</ul><p>Other preprocessing layers: 
<code><a href="layer_category_encoding.html">layer_category_encoding</a>()</code>,
<code><a href="layer_center_crop.html">layer_center_crop</a>()</code>,
<code><a href="layer_discretization.html">layer_discretization</a>()</code>,
<code><a href="layer_feature_space.html">layer_feature_space</a>()</code>,
<code><a href="layer_hashing.html">layer_hashing</a>()</code>,
<code><a href="layer_integer_lookup.html">layer_integer_lookup</a>()</code>,
<code><a href="layer_normalization.html">layer_normalization</a>()</code>,
<code><a href="layer_random_brightness.html">layer_random_brightness</a>()</code>,
<code><a href="layer_random_contrast.html">layer_random_contrast</a>()</code>,
<code><a href="layer_random_crop.html">layer_random_crop</a>()</code>,
<code><a href="layer_random_flip.html">layer_random_flip</a>()</code>,
<code><a href="layer_random_rotation.html">layer_random_rotation</a>()</code>,
<code><a href="layer_random_translation.html">layer_random_translation</a>()</code>,
<code><a href="layer_random_zoom.html">layer_random_zoom</a>()</code>,
<code><a href="layer_rescaling.html">layer_rescaling</a>()</code>,
<code><a href="layer_resizing.html">layer_resizing</a>()</code>,
<code><a href="layer_string_lookup.html">layer_string_lookup</a>()</code>,
<code><a href="layer_text_vectorization.html">layer_text_vectorization</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, RStudio, Google.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

