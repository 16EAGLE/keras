<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Base class for recurrent layer_ — layer_rnn • keras</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Base class for recurrent layer_ — layer_rnn"><meta property="og:description" content="Base class for recurrent layer_"><meta property="og:image" content="https://keras.posit.co/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">keras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.13.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_classification.html">Basic Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_text_classification.html">Text Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_regression.html">Basic Regression</a>
    </li>
    <li>
      <a href="../articles/tutorial_overfit_underfit.html">Overfitting and Underfitting</a>
    </li>
    <li>
      <a href="../articles/tutorial_save_and_restore.html">Save and Restore Models</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Guides (New for TF 2.6)</li>
    <li>
      <a href="../articles/new-guides/python_subclasses.html">Python Subclasses</a>
    </li>
    <li>
      <a href="../articles/new-guides/making_new_layers_and_models_via_subclassing.html">Making New Layers and Models via Subclassing</a>
    </li>
    <li>
      <a href="../articles/new-guides/customizing_what_happens_in_fit.html">Customizing What Happens in Fit</a>
    </li>
    <li>
      <a href="../articles/new-guides/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    </li>
    <li>
      <a href="../articles/new-guides/preprocessing_layers.html">Working with Preprocessing Layers</a>
    </li>
    <li>
      <a href="../argicles/new-guides/working_with_rnns.html">Working with RNNs</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Using Keras</li>
    <li>
      <a href="../articles/guide_keras.html">Guide to Keras Basics</a>
    </li>
    <li>
      <a href="../articles/sequential_model.html">Sequential Model in Depth</a>
    </li>
    <li>
      <a href="../articles/functional_api.html">Functional API in Depth</a>
    </li>
    <li>
      <a href="../articles/about_keras_models.html">About Keras Models</a>
    </li>
    <li>
      <a href="../articles/about_keras_layers.html">About Keras Layers</a>
    </li>
    <li>
      <a href="../articles/training_visualization.html">Training Visualization</a>
    </li>
    <li>
      <a href="../articles/applications.html">Pre-Trained Models</a>
    </li>
    <li>
      <a href="../articles/faq.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/why_use_keras.html">Why Use Keras?</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/eager_guide.html">Eager Execution</a>
    </li>
    <li>
      <a href="../articles/training_callbacks.html">Training Callbacks</a>
    </li>
    <li>
      <a href="../articles/backend.html">Keras Backend</a>
    </li>
    <li>
      <a href="../articles/custom_layers.html">Custom Layers</a>
    </li>
    <li>
      <a href="../articles/custom_models.html">Custom Models</a>
    </li>
    <li>
      <a href="../articles/saving_serializing.html">Saving and serializing</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/learn.html">Learn</a>
</li>
<li>
  <a href="../articles/tools.html">Tools</a>
</li>
<li>
  <a href="../articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rstudio/keras/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Base class for recurrent layer_</h1>
    <small class="dont-index">Source: <a href="https://github.com/rstudio/keras/blob/HEAD/R/autogen-layers-rnn.R" class="external-link"><code>R/autogen-layers-rnn.R</code></a></small>
    <div class="hidden name"><code>layer_rnn.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Base class for recurrent layer_</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">layer_rnn</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">cell</span>,</span>
<span>  return_sequences <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_state <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  go_backwards <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stateful <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  unroll <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  zero_output_for_mask <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Object to compose the layer with. A tensor, array, or sequential model.</p></dd>


<dt>cell</dt>
<dd><p>A RNN cell instance or a list of RNN cell instances.
A RNN cell is a class that has:</p><ul><li><p>A <code>call(input_at_t, states_at_t)</code> method, returning
<code>(output_at_t, states_at_t_plus_1)</code>. The call method of the
cell can also take the optional argument <code>constants</code>, see
section "Note on passing external constants" below.</p></li>
<li><p>A <code>state_size</code> attribute. This can be a single integer
(single state) in which case it is the size of the recurrent
state. This can also be a list of integers
(one size per state).</p></li>
<li><p>A <code>output_size</code> attribute, a single integer.</p></li>
<li><p>A <code>get_initial_state(batch_size=NULL)</code>
method that creates a tensor meant to be fed to <code><a href="https://rdrr.io/r/base/call.html" class="external-link">call()</a></code> as the
initial state, if the user didn't specify any initial state
via other means. The returned initial state should have
shape <code>(batch_size, cell.state_size)</code>.
The cell might choose to create a tensor full of zeros,
or other values based on the cell's implementation.
<code>inputs</code> is the input tensor to the RNN layer, with shape
<code>(batch_size, timesteps, features)</code>.
If this method is not implemented
by the cell, the RNN layer will create a zero filled tensor
with shape <code>(batch_size, cell$state_size)</code>.
In the case that <code>cell</code> is a list of RNN cell instances, the cells
will be stacked on top of each other in the RNN, resulting in an
efficient stacked RNN.</p></li>
</ul></dd>


<dt>return_sequences</dt>
<dd><p>Boolean (default <code>FALSE</code>). Whether to return the last
output in the output sequence, or the full sequence.</p></dd>


<dt>return_state</dt>
<dd><p>Boolean (default <code>FALSE</code>).
Whether to return the last state in addition to the output.</p></dd>


<dt>go_backwards</dt>
<dd><p>Boolean (default <code>FALSE</code>).
If <code>TRUE</code>, process the input sequence backwards and return the
reversed sequence.</p></dd>


<dt>stateful</dt>
<dd><p>Boolean (default <code>FALSE</code>). If TRUE, the last state
for each sample at index <code>i</code> in a batch will be used as initial
state for the sample of index <code>i</code> in the following batch.</p></dd>


<dt>unroll</dt>
<dd><p>Boolean (default <code>FALSE</code>).
If TRUE, the network will be unrolled, else a symbolic loop will be
used. Unrolling can speed-up a RNN, although it tends to be more
memory-intensive. Unrolling is only suitable for short sequences.</p></dd>


<dt>zero_output_for_mask</dt>
<dd><p>Boolean (default <code>FALSE</code>).
Whether the output should use zeros for the masked timesteps.
Note that this field is only used when <code>return_sequences</code>
is <code>TRUE</code> and <code>mask</code> is provided.
It can useful if you want to reuse the raw output sequence of
the RNN without interference from the masked timesteps, e.g.,
merging bidirectional RNNs.</p></dd>


<dt>...</dt>
<dd><p>Passed on to the Python callable</p></dd>

</dl></div>
    <div id="call-arguments">
    <h2>Call Arguments</h2>
    
<ul><li><p><code>inputs</code>: Input tensor.</p></li>
<li><p><code>initial_state</code>: List of initial state tensors to be passed to the first
call of the cell.</p></li>
<li><p><code>mask</code>: Binary tensor of shape <code>[batch_size, timesteps]</code>
indicating whether a given timestep should be masked.
An individual <code>TRUE</code> entry indicates that the corresponding
timestep should be utilized, while a <code>FALSE</code> entry indicates
that the corresponding timestep should be ignored.</p></li>
<li><p><code>training</code>: Python boolean indicating whether the layer should behave in
training mode or in inference mode. This argument is passed
to the cell when calling it.
This is for use with cells that use dropout.</p></li>
</ul></div>
    <div id="input-shape">
    <h2>Input Shape</h2>
    <p>3-D tensor with shape <code>(batch_size, timesteps, features)</code>.</p>
    </div>
    <div id="output-shape">
    <h2>Output Shape</h2>
    
<ul><li><p>If <code>return_state</code>: a list of tensors. The first tensor is
the output. The remaining tensors are the last states,
each with shape <code>(batch_size, state_size)</code>, where <code>state_size</code> could
be a high dimension tensor shape.</p></li>
<li><p>If <code>return_sequences</code>: 3D tensor with shape
<code>(batch_size, timesteps, output_size)</code>.</p></li>
</ul><p>Masking:</p>
<p>This layer supports masking for input data with a variable number
of timesteps. To introduce masks to your data,
use a <code>layer_Embedding</code> layer with the <code>mask_zero</code> parameter
set to <code>TRUE</code>.</p>
<p>Note on using statefulness in RNNs:</p>
<p>You can set RNN layers to be 'stateful', which means that the states
computed for the samples in one batch will be reused as initial states
for the samples in the next batch. This assumes a one-to-one mapping
between samples in different successive batches.</p>
<p>To enable statefulness:</p><ul><li><p>Specify <code>stateful=TRUE</code> in the layer constructor.</p></li>
<li><p>Specify a fixed batch size for your model, by passing
If sequential model:
<code>batch_input_shape=(...)</code> to the first layer in your model.
Else for functional model with 1 or more Input layers:
<code>batch_shape=(...)</code> to all the first layers in your model.
This is the expected shape of your inputs
<em>including the batch size</em>.
It should be a list of integers, e.g. <code>(32, 10, 100)</code>.</p></li>
<li><p>Specify <code>shuffle=FALSE</code> when calling <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code>.</p></li>
</ul><p>To reset the states of your model, call <code>.reset_states()</code> on either
a specific layer, or on your entire model.</p>
<p>Note on specifying the initial state of RNNs:</p>
<p>You can specify the initial state of RNN layers symbolically by
calling them with the keyword argument <code>initial_state</code>. The value of
<code>initial_state</code> should be a tensor or list of tensors representing
the initial state of the RNN layer.</p>
<p>You can specify the initial state of RNN layers numerically by
calling <code>reset_states</code> with the keyword argument <code>states</code>. The value of
<code>states</code> should be a numpy array or list of numpy arrays representing
the initial state of the RNN layer.</p>
    </div>
    <div id="examples">
    <h2>Examples</h2>
    <p></p><div class="sourceCode r"><pre><code><span><span class="co"># First, let's define a RNN Cell, as a layer subclass.</span></span>
<span><span class="fu">MinimalRNNCell</span><span class="op">(</span><span class="va">keras</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-py_class-grapes.html">%py_class%</a></span> <span class="op">{</span></span>
<span>  <span class="va">initialize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">units</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">state_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">units</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">build</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input_shape</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">kernel</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">add_weight</span><span class="op">(</span></span>
<span>      shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">input_shape</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">self</span><span class="op">$</span><span class="va">units</span><span class="op">)</span>,</span>
<span>      initializer <span class="op">=</span> <span class="st">'uniform'</span>,</span>
<span>      name <span class="op">=</span> <span class="st">'kernel'</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">recurrent_kernel</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">add_weight</span><span class="op">(</span></span>
<span>      shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">units</span>, <span class="va">self</span><span class="op">$</span><span class="va">units</span><span class="op">)</span>,</span>
<span>      initializer <span class="op">=</span> <span class="st">'uniform'</span>,</span>
<span>      name <span class="op">=</span> <span class="st">'recurrent_kernel'</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">built</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">call</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputs</span>, <span class="va">states</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">prev_output</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/k_matmul.html">k_matmul</a></span><span class="op">(</span><span class="va">inputs</span>, <span class="va">self.kernel</span><span class="op">)</span></span>
<span>    <span class="va">output</span> <span class="op">&lt;-</span> <span class="va">h</span> <span class="op">+</span> <span class="fu"><a href="../reference/k_matmul.html">k_matmul</a></span><span class="op">(</span><span class="va">prev_output</span>, <span class="va">self</span><span class="op">$</span><span class="va">recurrent_kernel</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">output</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Let's use this cell in a RNN layer:</span></span>
<span></span>
<span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu">MinimalRNNCell</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">32</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/shape.html" class="external-link">shape</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_rnn.html">layer_rnn</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="va">cell</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">layer</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here's how to use the cell to build a stacked RNN:</span></span>
<span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">MinimalRNNCell</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">32</span><span class="op">)</span>, <span class="fu">MinimalRNNCell</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/shape.html" class="external-link">shape</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_rnn.html">layer_rnn</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="va">cells</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">layer</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><a href="https:/keras.io/api/layers/recurrent_layers/rnn#rnn-class">https:/keras.io/api/layers/recurrent_layers/rnn#rnn-class</a></p></li>
<li><p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/RNN" class="external-link">https://www.tensorflow.org/api_docs/python/tf/keras/layers/RNN</a></p></li>
</ul><p>Other rnn layers: 
<code><a href="bidirectional.html">bidirectional</a>()</code>,
<code><a href="layer_conv_lstm_1d.html">layer_conv_lstm_1d</a>()</code>,
<code><a href="layer_conv_lstm_2d.html">layer_conv_lstm_2d</a>()</code>,
<code><a href="layer_conv_lstm_3d.html">layer_conv_lstm_3d</a>()</code>,
<code><a href="layer_gru_cell.html">layer_gru_cell</a>()</code>,
<code><a href="layer_gru.html">layer_gru</a>()</code>,
<code><a href="layer_lstm_cell.html">layer_lstm_cell</a>()</code>,
<code><a href="layer_lstm.html">layer_lstm</a>()</code>,
<code><a href="layer_simple_rnn_cell.html">layer_simple_rnn_cell</a>()</code>,
<code><a href="layer_simple_rnn.html">layer_simple_rnn</a>()</code>,
<code><a href="layer_stacked_rnn_cells.html">layer_stacked_rnn_cells</a>()</code>,
<code><a href="layer_time_distributed.html">layer_time_distributed</a>()</code></p>
<p>Other layers: 
<code><a href="bidirectional.html">bidirectional</a>()</code>,
<code><a href="layer_activation_elu.html">layer_activation_elu</a>()</code>,
<code><a href="layer_activation_leaky_relu.html">layer_activation_leaky_relu</a>()</code>,
<code><a href="layer_activation_parametric_relu.html">layer_activation_parametric_relu</a>()</code>,
<code><a href="layer_activation_relu.html">layer_activation_relu</a>()</code>,
<code><a href="layer_activation_softmax.html">layer_activation_softmax</a>()</code>,
<code><a href="layer_activation.html">layer_activation</a>()</code>,
<code><a href="layer_activity_regularization.html">layer_activity_regularization</a>()</code>,
<code><a href="layer_additive_attention.html">layer_additive_attention</a>()</code>,
<code><a href="layer_add.html">layer_add</a>()</code>,
<code><a href="layer_attention.html">layer_attention</a>()</code>,
<code><a href="layer_average_pooling_1d.html">layer_average_pooling_1d</a>()</code>,
<code><a href="layer_average_pooling_2d.html">layer_average_pooling_2d</a>()</code>,
<code><a href="layer_average_pooling_3d.html">layer_average_pooling_3d</a>()</code>,
<code><a href="layer_average.html">layer_average</a>()</code>,
<code><a href="layer_batch_normalization.html">layer_batch_normalization</a>()</code>,
<code><a href="layer_category_encoding.html">layer_category_encoding</a>()</code>,
<code><a href="layer_center_crop.html">layer_center_crop</a>()</code>,
<code><a href="layer_concatenate.html">layer_concatenate</a>()</code>,
<code><a href="layer_conv_1d_transpose.html">layer_conv_1d_transpose</a>()</code>,
<code><a href="layer_conv_1d.html">layer_conv_1d</a>()</code>,
<code><a href="layer_conv_2d_transpose.html">layer_conv_2d_transpose</a>()</code>,
<code><a href="layer_conv_2d.html">layer_conv_2d</a>()</code>,
<code><a href="layer_conv_3d_transpose.html">layer_conv_3d_transpose</a>()</code>,
<code><a href="layer_conv_3d.html">layer_conv_3d</a>()</code>,
<code><a href="layer_conv_lstm_1d.html">layer_conv_lstm_1d</a>()</code>,
<code><a href="layer_conv_lstm_2d.html">layer_conv_lstm_2d</a>()</code>,
<code><a href="layer_conv_lstm_3d.html">layer_conv_lstm_3d</a>()</code>,
<code><a href="layer_cropping_1d.html">layer_cropping_1d</a>()</code>,
<code><a href="layer_cropping_2d.html">layer_cropping_2d</a>()</code>,
<code><a href="layer_cropping_3d.html">layer_cropping_3d</a>()</code>,
<code><a href="layer_dense.html">layer_dense</a>()</code>,
<code><a href="layer_depthwise_conv_1d.html">layer_depthwise_conv_1d</a>()</code>,
<code><a href="layer_depthwise_conv_2d.html">layer_depthwise_conv_2d</a>()</code>,
<code><a href="layer_discretization.html">layer_discretization</a>()</code>,
<code><a href="layer_dot.html">layer_dot</a>()</code>,
<code><a href="layer_dropout.html">layer_dropout</a>()</code>,
<code><a href="layer_einsum_dense.html">layer_einsum_dense</a>()</code>,
<code><a href="layer_embedding.html">layer_embedding</a>()</code>,
<code><a href="layer_feature_space.html">layer_feature_space</a>()</code>,
<code><a href="layer_flatten.html">layer_flatten</a>()</code>,
<code><a href="layer_gaussian_dropout.html">layer_gaussian_dropout</a>()</code>,
<code><a href="layer_gaussian_noise.html">layer_gaussian_noise</a>()</code>,
<code><a href="layer_global_average_pooling_1d.html">layer_global_average_pooling_1d</a>()</code>,
<code><a href="layer_global_average_pooling_2d.html">layer_global_average_pooling_2d</a>()</code>,
<code><a href="layer_global_average_pooling_3d.html">layer_global_average_pooling_3d</a>()</code>,
<code><a href="layer_global_max_pooling_1d.html">layer_global_max_pooling_1d</a>()</code>,
<code><a href="layer_global_max_pooling_2d.html">layer_global_max_pooling_2d</a>()</code>,
<code><a href="layer_global_max_pooling_3d.html">layer_global_max_pooling_3d</a>()</code>,
<code><a href="layer_group_normalization.html">layer_group_normalization</a>()</code>,
<code><a href="layer_group_query_attention.html">layer_group_query_attention</a>()</code>,
<code><a href="layer_gru_cell.html">layer_gru_cell</a>()</code>,
<code><a href="layer_gru.html">layer_gru</a>()</code>,
<code><a href="layer_hashed_crossing.html">layer_hashed_crossing</a>()</code>,
<code><a href="layer_hashing.html">layer_hashing</a>()</code>,
<code><a href="layer_identity.html">layer_identity</a>()</code>,
<code><a href="layer_input.html">layer_input</a>()</code>,
<code><a href="layer_integer_lookup.html">layer_integer_lookup</a>()</code>,
<code><a href="layer_lambda.html">layer_lambda</a>()</code>,
<code><a href="layer_layer_normalization.html">layer_layer_normalization</a>()</code>,
<code><a href="layer_lstm_cell.html">layer_lstm_cell</a>()</code>,
<code><a href="layer_lstm.html">layer_lstm</a>()</code>,
<code><a href="layer_masking.html">layer_masking</a>()</code>,
<code><a href="layer_max_pooling_1d.html">layer_max_pooling_1d</a>()</code>,
<code><a href="layer_max_pooling_2d.html">layer_max_pooling_2d</a>()</code>,
<code><a href="layer_max_pooling_3d.html">layer_max_pooling_3d</a>()</code>,
<code><a href="layer_maximum.html">layer_maximum</a>()</code>,
<code><a href="layer_minimum.html">layer_minimum</a>()</code>,
<code><a href="layer_multi_head_attention.html">layer_multi_head_attention</a>()</code>,
<code><a href="layer_multiply.html">layer_multiply</a>()</code>,
<code><a href="layer_normalization.html">layer_normalization</a>()</code>,
<code><a href="layer_permute.html">layer_permute</a>()</code>,
<code><a href="layer_random_brightness.html">layer_random_brightness</a>()</code>,
<code><a href="layer_random_contrast.html">layer_random_contrast</a>()</code>,
<code><a href="layer_random_crop.html">layer_random_crop</a>()</code>,
<code><a href="layer_random_flip.html">layer_random_flip</a>()</code>,
<code><a href="layer_random_rotation.html">layer_random_rotation</a>()</code>,
<code><a href="layer_random_translation.html">layer_random_translation</a>()</code>,
<code><a href="layer_random_zoom.html">layer_random_zoom</a>()</code>,
<code><a href="layer_repeat_vector.html">layer_repeat_vector</a>()</code>,
<code><a href="layer_rescaling.html">layer_rescaling</a>()</code>,
<code><a href="layer_reshape.html">layer_reshape</a>()</code>,
<code><a href="layer_resizing.html">layer_resizing</a>()</code>,
<code><a href="layer_separable_conv_1d.html">layer_separable_conv_1d</a>()</code>,
<code><a href="layer_separable_conv_2d.html">layer_separable_conv_2d</a>()</code>,
<code><a href="layer_simple_rnn_cell.html">layer_simple_rnn_cell</a>()</code>,
<code><a href="layer_simple_rnn.html">layer_simple_rnn</a>()</code>,
<code><a href="layer_spatial_dropout_1d.html">layer_spatial_dropout_1d</a>()</code>,
<code><a href="layer_spatial_dropout_2d.html">layer_spatial_dropout_2d</a>()</code>,
<code><a href="layer_spatial_dropout_3d.html">layer_spatial_dropout_3d</a>()</code>,
<code><a href="layer_spectral_normalization.html">layer_spectral_normalization</a>()</code>,
<code><a href="layer_stacked_rnn_cells.html">layer_stacked_rnn_cells</a>()</code>,
<code><a href="layer_string_lookup.html">layer_string_lookup</a>()</code>,
<code><a href="layer_subtract.html">layer_subtract</a>()</code>,
<code><a href="layer_text_vectorization.html">layer_text_vectorization</a>()</code>,
<code><a href="layer_time_distributed.html">layer_time_distributed</a>()</code>,
<code><a href="layer_unit_normalization.html">layer_unit_normalization</a>()</code>,
<code><a href="layer_upsampling_1d.html">layer_upsampling_1d</a>()</code>,
<code><a href="layer_upsampling_2d.html">layer_upsampling_2d</a>()</code>,
<code><a href="layer_upsampling_3d.html">layer_upsampling_3d</a>()</code>,
<code><a href="layer_zero_padding_1d.html">layer_zero_padding_1d</a>()</code>,
<code><a href="layer_zero_padding_2d.html">layer_zero_padding_2d</a>()</code>,
<code><a href="layer_zero_padding_3d.html">layer_zero_padding_3d</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, RStudio, Google.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

