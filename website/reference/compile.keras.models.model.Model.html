<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Configure a Keras model for training"><title>Configure a Keras model for training — compile.keras.models.model.Model • keras3</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Configure a Keras model for training — compile.keras.models.model.Model"><meta property="og:description" content="Configure a Keras model for training"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">keras3</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.13.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-getting-started">Getting Started</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-getting-started">
    <a class="dropdown-item" href="../articles/intro_to_keras_for_engineers.html">Introduction to Keras for engineers</a>
    <h6 class="dropdown-header" data-toc-skip>Tutorials</h6>
    <a class="dropdown-item" href="../articles/getting_started.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/tutorial_basic_classification.html">Basic Classification</a>
    <a class="dropdown-item" href="../articles/tutorial_basic_text_classification.html">Text Classification</a>
    <a class="dropdown-item" href="../articles/tutorial_basic_regression.html">Basic Regression</a>
    <a class="dropdown-item" href="../articles/tutorial_overfit_underfit.html">Overfitting and Underfitting</a>
    <a class="dropdown-item" href="../articles/tutorial_save_and_restore.html">Save and Restore Models</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-guides">Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-guides">
    <h6 class="dropdown-header" data-toc-skip>Model definition</h6>
    <a class="dropdown-item" href="../articles/functional_api.html">Functional API</a>
    <a class="dropdown-item" href="../articles/sequential_model.html">Sequential Model</a>
    <h6 class="dropdown-header" data-toc-skip>Extending and customizing</h6>
    <a class="dropdown-item" href="../articles/making_new_layers_and_models_via_subclassing.html">Making new layers and models via subclassing</a>
    <a class="dropdown-item" href="../articles/training_with_built_in_methods.html">Training &amp; evaluation with the built-in methods</a>
    <a class="dropdown-item" href="../articles/writing_a_custom_training_loop_in_tensorflow.html">Writing a training loop from scratch in TensorFlow</a>
    <a class="dropdown-item" href="../articles/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    <h6 class="dropdown-header" data-toc-skip>Other topics</h6>
    <a class="dropdown-item" href="../articles/transfer_learning.html">Transfer learning and fine tuning</a>
    <a class="dropdown-item" href="../articles/distributed_training_with_tensorflow.html">Distributed training with TensorFlow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/examples/index.html">Examples</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rstudio/keras/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Configure a Keras model for training</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/keras/blob/HEAD/R/model.R" class="external-link"><code>R/model.R</code></a></small>
      <div class="d-none name"><code>compile.keras.models.model.Model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Configure a Keras model for training</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for keras.models.model.Model</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/compile.html" class="external-link">compile</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loss <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loss_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weighted_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  run_eagerly <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  steps_per_execution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  target_tensors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_weight_mode <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>Model object to compile.</p></dd>


<dt>optimizer</dt>
<dd><p>String (name of optimizer) or optimizer instance. For most
models, this defaults to <code>"rmsprop"</code></p></dd>


<dt>loss</dt>
<dd><p>String (name of objective function), objective function or a
<code>keras$losses$Loss</code> subclass instance. An objective function is any
callable with the signature <code>loss = fn(y_true, y_pred)</code>, where y_true =
ground truth values with shape = <code>[batch_size, d0, .. dN]</code>, except sparse
loss functions such as sparse categorical crossentropy where shape =
<code>[batch_size, d0, .. dN-1]</code>. y_pred = predicted values with shape =
<code>[batch_size, d0, .. dN]</code>. It returns a weighted loss float tensor. If a
custom <code>Loss</code> instance is used and reduction is set to <code>NULL</code>, return value
has the shape <code>[batch_size, d0, .. dN-1]</code> i.e. per-sample or per-timestep
loss values; otherwise, it is a scalar. If the model has multiple outputs,
you can use a different loss on each output by passing a dictionary or a
list of losses. The loss value that will be minimized by the model will
then be the sum of all individual losses, unless <code>loss_weights</code> is
specified.</p></dd>


<dt>metrics</dt>
<dd><p>List of metrics to be evaluated by the model during training
and testing. Each of this can be a string (name of a built-in function),
function or a <code>keras$metrics$Metric</code> class instance. See
<code>?tf$keras$metrics</code>. Typically you will use <code>metrics=list('accuracy')</code>. A
function is any callable with the signature <code>result = fn(y_true, y_pred)</code>.
To specify different metrics for different outputs of a multi-output model,
you could also pass a dictionary, such as <code>metrics=list(output_a = 'accuracy', output_b = c('accuracy', 'mse'))</code>. You can also pass a list to
specify a metric or a list of metrics for each output, such as
<code>metrics=list(list('accuracy'), list('accuracy', 'mse'))</code> or
<code>metrics=list('accuracy', c('accuracy', 'mse'))</code>. When you pass the strings
<code>'accuracy'</code> or <code>'acc'</code>, this is converted to one of
<code>tf.keras.metrics.BinaryAccuracy</code>, <code>tf.keras.metrics.CategoricalAccuracy</code>,
<code>tf.keras.metrics.SparseCategoricalAccuracy</code> based on the loss function
used and the model output shape. A similar conversion is done for the
strings <code>'crossentropy'</code> and <code>'ce'</code>.</p></dd>


<dt>loss_weights</dt>
<dd><p>Optional list, dictionary, or named vector specifying
scalar numeric coefficients to weight the loss contributions of different
model outputs. The loss value that will be minimized by the model will then
be the <em>weighted sum</em> of all individual losses, weighted by the
<code>loss_weights</code> coefficients. If a list, it is expected to have a 1:1
mapping to the model's outputs. If a dict, it is expected to map output
names (strings) to scalar coefficients.</p></dd>


<dt>weighted_metrics</dt>
<dd><p>List of metrics to be evaluated and weighted by
<code>sample_weight</code> or <code>class_weight</code> during training and testing.</p></dd>


<dt>run_eagerly</dt>
<dd><p>Bool. Defaults to <code>FALSE</code>. If <code>TRUE</code>, this Model's logic
will not be wrapped in a <code>tf.function</code>. Recommended to leave this as <code>NULL</code>
unless your Model cannot be run inside a <code>tf.function</code>. <code>run_eagerly=TRUE</code>
is not supported when using
<code>tf.distribute.experimental.ParameterServerStrategy</code>. If the model's logic
uses tensors in R control flow expressions like <code>if</code> and <code>for</code>, the model
is still traceable with <code>tf.function</code>, but you will have to enter a
<code>tfautograph::autograph({})</code> directly.</p></dd>


<dt>steps_per_execution</dt>
<dd><p>Int. Defaults to 1. The number of batches to run
during each <code>tf.function</code> call. Running multiple batches inside a single
<code>tf.function</code> call can greatly improve performance on TPUs or small models
with a large Python/R overhead. At most, one full epoch will be run each
execution. If a number larger than the size of the epoch is passed, the
execution will be truncated to the size of the epoch. Note that if
<code>steps_per_execution</code> is set to <code>N</code>, <code>Callback.on_batch_begin</code> and
<code>Callback.on_batch_end</code> methods will only be called every <code>N</code> batches (i.e.
before/after each <code>tf.function</code> execution).</p></dd>


<dt>...</dt>
<dd><p>Arguments supported for backwards compatibility only.</p></dd>


<dt>target_tensors</dt>
<dd><p>By default, Keras will create a placeholder for the
model's target, which will be fed with the target data during training. If
instead you would like to use your own target tensor (in turn, Keras will
not expect external data for these targets at training time), you can
specify them via the <code>target_tensors</code> argument. It should be a single
tensor (for a single-output sequential model).</p></dd>


<dt>sample_weight_mode</dt>
<dd><p>If you need to do timestep-wise sample weighting
(2D weights), set this to "temporal". <code>NULL</code> defaults to sample-wise
weights (1D). If the model has multiple outputs, you can use a different
<code>sample_weight_mode</code> on each output by passing a list of modes.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other model functions: 
<code><a href="evaluate.keras.models.model.Model.html">evaluate.keras.models.model.Model</a>()</code>,
<code><a href="evaluate_generator.html">evaluate_generator</a>()</code>,
<code><a href="fit.keras.models.model.Model.html">fit.keras.models.model.Model</a>()</code>,
<code><a href="fit_generator.html">fit_generator</a>()</code>,
<code><a href="get_config.html">get_config</a>()</code>,
<code><a href="get_layer.html">get_layer</a>()</code>,
<code><a href="keras_model_sequential.html">keras_model_sequential</a>()</code>,
<code><a href="keras_model.html">keras_model</a>()</code>,
<code><a href="pop_layer.html">pop_layer</a>()</code>,
<code><a href="predict.keras.models.model.Model.html">predict.keras.models.model.Model</a>()</code>,
<code><a href="predict_generator.html">predict_generator</a>()</code>,
<code><a href="predict_on_batch.html">predict_on_batch</a>()</code>,
<code><a href="predict_proba.html">predict_proba</a>()</code>,
<code><a href="summary.keras.models.model.Model.html">summary.keras.models.model.Model</a>()</code>,
<code><a href="train_on_batch.html">train_on_batch</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, Posit Software, PBC, Google.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

