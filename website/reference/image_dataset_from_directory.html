<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a dataset from a directory — image_dataset_from_directory • keras</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Create a dataset from a directory — image_dataset_from_directory"><meta property="og:description" content="Generates a tf.data.Dataset from image files in a directory."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">keras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.8.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_classification.html">Basic Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_text_classification.html">Text Classification</a>
    </li>
    <li>
      <a href="../articles/tutorial_basic_regression.html">Basic Regression</a>
    </li>
    <li>
      <a href="../articles/tutorial_overfit_underfit.html">Overfitting and Underfitting</a>
    </li>
    <li>
      <a href="../articles/tutorial_save_and_restore.html">Save and Restore Models</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Guides (New for TF 2.6)</li>
    <li>
      <a href="../articles/new-guides/python_subclasses.html">Python Subclasses</a>
    </li>
    <li>
      <a href="../articles/new-guides/making_new_layers_and_models_via_subclassing.html">Making New Layers and Models via Subclassing</a>
    </li>
    <li>
      <a href="../articles/new-guides/customizing_what_happens_in_fit.html">Customizing What Happens in Fit</a>
    </li>
    <li>
      <a href="../articles/new-guides/writing_your_own_callbacks.html">Writing Your Own Callbacks</a>
    </li>
    <li>
      <a href="../articles/new-guides/preprocessing_layers.html">Working with Preprocessing Layers</a>
    </li>
    <li>
      <a href="../argicles/new-guides/working_with_rnns.html">Working with RNNs</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Using Keras</li>
    <li>
      <a href="../articles/guide_keras.html">Guide to Keras Basics</a>
    </li>
    <li>
      <a href="../articles/sequential_model.html">Sequential Model in Depth</a>
    </li>
    <li>
      <a href="../articles/functional_api.html">Functional API in Depth</a>
    </li>
    <li>
      <a href="../articles/about_keras_models.html">About Keras Models</a>
    </li>
    <li>
      <a href="../articles/about_keras_layers.html">About Keras Layers</a>
    </li>
    <li>
      <a href="../articles/training_visualization.html">Training Visualization</a>
    </li>
    <li>
      <a href="../articles/applications.html">Pre-Trained Models</a>
    </li>
    <li>
      <a href="../articles/faq.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/why_use_keras.html">Why Use Keras?</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/eager_guide.html">Eager Execution</a>
    </li>
    <li>
      <a href="../articles/training_callbacks.html">Training Callbacks</a>
    </li>
    <li>
      <a href="../articles/backend.html">Keras Backend</a>
    </li>
    <li>
      <a href="../articles/custom_layers.html">Custom Layers</a>
    </li>
    <li>
      <a href="../articles/custom_models.html">Custom Models</a>
    </li>
    <li>
      <a href="../articles/saving_serializing.html">Saving and serializing</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/learn.html">Learn</a>
</li>
<li>
  <a href="../articles/tools.html">Tools</a>
</li>
<li>
  <a href="../articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rstudio/keras/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a dataset from a directory</h1>
    <small class="dont-index">Source: <a href="https://github.com/rstudio/keras/blob/HEAD/R/preprocessing.R" class="external-link"><code>R/preprocessing.R</code></a></small>
    <div class="hidden name"><code>image_dataset_from_directory.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a <code>tf.data.Dataset</code> from image files in a directory.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">image_dataset_from_directory</span><span class="op">(</span>
  <span class="va">directory</span>,
  labels <span class="op">=</span> <span class="st">"inferred"</span>,
  label_mode <span class="op">=</span> <span class="st">"int"</span>,
  class_names <span class="op">=</span> <span class="cn">NULL</span>,
  color_mode <span class="op">=</span> <span class="st">"rgb"</span>,
  batch_size <span class="op">=</span> <span class="fl">32</span>,
  image_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">256</span>, <span class="fl">256</span><span class="op">)</span>,
  shuffle <span class="op">=</span> <span class="cn">TRUE</span>,
  seed <span class="op">=</span> <span class="cn">NULL</span>,
  validation_split <span class="op">=</span> <span class="cn">NULL</span>,
  subset <span class="op">=</span> <span class="cn">NULL</span>,
  interpolation <span class="op">=</span> <span class="st">"bilinear"</span>,
  follow_links <span class="op">=</span> <span class="cn">FALSE</span>,
  crop_to_aspect_ratio <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>directory</dt>
<dd><p>Directory where the data is located. If labels is
"inferred", it should contain subdirectories, each containing images for a
class. Otherwise, the directory structure is ignored.</p></dd>
<dt>labels</dt>
<dd><p>Either "inferred" (labels are generated from the directory
structure), or a list/tuple of integer labels of the same size as the
number of image files found in the directory. Labels should be sorted
according to the alphanumeric order of the image file paths (obtained via
os.walk(directory) in Python).</p></dd>
<dt>label_mode</dt>
<dd><p>Valid values:</p><ul><li><p>'int': labels are encoded as integers (e.g.
for sparse_categorical_crossentropy loss).</p></li>
<li><p>'categorical': labels are encoded as a categorical vector (e.g. for
categorical_crossentropy loss).</p></li>
<li><p>'binary': labels (there can be only 2) are encoded as float32 scalars
with values 0 or 1 (e.g. for binary_crossentropy).</p></li>
<li><p><code>NULL</code>: (no labels).</p></li>
</ul></dd>
<dt>class_names</dt>
<dd><p>Only valid if "labels" is "inferred". This is the explict
list of class names (must match names of subdirectories). Used to control
the order of the classes (otherwise alphanumerical order is used).</p></dd>
<dt>color_mode</dt>
<dd><p>One of "grayscale", "rgb", "rgba". Default: "rgb". Whether
the images will be converted to have 1, 3, or 4 channels.</p></dd>
<dt>batch_size</dt>
<dd><p>Size of the batches of data. Default: 32.</p></dd>
<dt>image_size</dt>
<dd><p>Size to resize images to after they are read from disk.
Defaults to (256, 256). Since the pipeline processes batches of images that
must all have the same size, this must be provided.</p></dd>
<dt>shuffle</dt>
<dd><p>Whether to shuffle the data. Default: TRUE. If set to FALSE,
sorts the data in alphanumeric order.</p></dd>
<dt>seed</dt>
<dd><p>Optional random seed for shuffling and transformations.</p></dd>
<dt>validation_split</dt>
<dd><p>Optional float between 0 and 1, fraction of data to
reserve for validation.</p></dd>
<dt>subset</dt>
<dd><p>One of "training" or "validation". Only used if
validation_split is set.</p></dd>
<dt>interpolation</dt>
<dd><p>String, the interpolation method used when resizing
images. Defaults to bilinear. Supports bilinear, nearest, bicubic, area,
lanczos3, lanczos5, gaussian, mitchellcubic.</p></dd>
<dt>follow_links</dt>
<dd><p>Whether to visits subdirectories pointed to by symlinks.
Defaults to FALSE.</p></dd>
<dt>crop_to_aspect_ratio</dt>
<dd><p>If <code>TRUE</code>, resize the images without aspect ratio
distortion. When the original aspect ratio differs from the target aspect
ratio, the output image will be cropped so as to return the largest
possible window in the image (of size image_size) that matches the target
aspect ratio. By default (crop_to_aspect_ratio=False), aspect ratio may not
be preserved.</p></dd>
<dt>...</dt>
<dd><p>Legacy arguments</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A tf.data.Dataset object. If label_mode is <code>NULL</code>, it yields float32
tensors of shape <code>(batch_size, image_size[1], image_size[2], num_channels)</code>,
encoding images (see below for rules regarding <code>num_channels</code>).
Otherwise, it yields pairs of <code>(images, labels)</code>, where images has shape
<code>(batch_size, image_size[1], image_size[2], num_channels)</code>, and labels
follows the format described below.
Rules regarding labels format:</p><ul><li><p>if label_mode is int, the labels are an int32 tensor of shape
<code>(batch_size)</code>.</p></li>
<li><p>if label_mode is binary, the labels are a float32 tensor of 1s and 0s of
shape <code>(batch_size, 1)</code>.</p></li>
<li><p>if label_mode is categorial, the labels are a float32 tensor of shape
<code>(batch_size, num_classes)</code>, representing a one-hot encoding of the class
index.</p></li>
</ul><p>Rules regarding number of channels in the yielded images:</p><ul><li><p>if color_mode is grayscale, there's 1 channel in the image tensors.</p></li>
<li><p>if color_mode is rgb, there are 3 channel in the image tensors.</p></li>
<li><p>if color_mode is rgba, there are 4 channel in the image tensors.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>If your directory structure is:</p><div class="sourceCode"><pre><code><span class="va">main_directory</span><span class="op">/</span>
<span class="va">...class_a</span><span class="op">/</span>
<span class="va">......a_image_1.jpg</span>
<span class="va">......a_image_2.jpg</span>
<span class="va">...class_b</span><span class="op">/</span>
<span class="va">......b_image_1.jpg</span>
<span class="va">......b_image_2.jpg</span></code></pre></div>

<p>Then calling <code>image_dataset_from_directory(main_directory, labels='inferred')</code>
will return a <code>tf.data.Dataset</code> that yields batches of images from the
subdirectories class_a and class_b, together with labels 0 and 1 (0
corresponding to class_a and 1 corresponding to class_b).</p>
<p>Supported image formats: jpeg, png, bmp, gif. Animated gifs are truncated to
the first frame.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/utils/image_dataset_from_directory" class="external-link">https://www.tensorflow.org/api_docs/python/tf/keras/utils/image_dataset_from_directory</a></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, RStudio, Google.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

