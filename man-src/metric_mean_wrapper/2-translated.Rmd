---
knit: ({source(here::here("tools/knit.R")); knit_man_src})
---
Wrap a stateless metric function with the Mean metric.

@description
You could use this class to quickly build a mean metric from a function. The
function needs to have the signature `fn(y_true, y_pred)` and return a
per-sample loss array. `metric_mean_wrapper$result()` will return
the average metric value across all samples seen so far.

For example:

```{r}
mse <- function(y_true, y_pred) {
  (y_true - y_pred)^2
}

mse_metric <- metric_mean_wrapper(fn = mse)
mse_metric$update_state(c(0, 1), c(1, 1))
mse_metric$result()
```

@param fn
The metric function to wrap, with signature
`fn(y_true, y_pred)`.

@param name
(Optional) string name of the metric instance.

@param dtype
(Optional) data type of the metric result.

@param ...
Keyword arguments to pass on to `fn`.

@export
@family reduction metrics
@family metrics
@seealso
+ <https://www.tensorflow.org/api_docs/python/tf/keras/metrics/MeanMetricWrapper>

