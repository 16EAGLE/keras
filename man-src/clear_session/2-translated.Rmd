---
knit: ({source(here::here("tools/knit.R")); knit_man_src})
---
Resets all state generated by Keras.

@description
Keras manages a global state, which it uses to implement the Functional
model-building API and to uniquify autogenerated layer names.

If you are creating many models in a loop, this global state will consume
an increasing amount of memory over time, and you may want to clear it.
Calling `clear_session()` releases the global state: this helps avoid
clutter from old models and layers, especially when memory is limited.

Example 1: calling `clear_session()` when creating models in a loop

```{r}
for (i in 1:100) {
  # Without `clear_session()`, each iteration of this loop will
  # slightly increase the size of the global state managed by Keras
  model <- keras_model_sequential()
  for (j in 1:10) {
    model <- model |> layer_dense(units = 10)
  }
}

for (i in 1:100) {
  # With `clear_session()` called at the beginning,
  # Keras starts with a blank state at each iteration
  # and memory consumption is constant over time.
  clear_session()
  model <- keras_model_sequential()
  for (j in 1:10) {
    model <- model |> layer_dense(units = 10)
  }
}
```

Example 2: resetting the layer name generation counter

```{r, include = FALSE}
clear_session()
```


```{r}
layers <- lapply(1:10, \(i) layer_dense(units = 10))

new_layer <- layer_dense(units = 10)
print(new_layer$name)

clear_session()
new_layer <- layer_dense(units = 10)
print(new_layer$name)
```

@export
@family state global common backend
@family global common backend
@family common backend
@family backend
@seealso
+ <https:/keras.io/keras_core/api/utils/config_utils#clearsession-function>
+ <https://www.tensorflow.org/api_docs/python/tf/keras/utils/clear_session>
