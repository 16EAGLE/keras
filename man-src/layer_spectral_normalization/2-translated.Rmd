---
knit: ({source(here::here("tools/knit.R")); knit_man_src})
---
Performs spectral normalization on the weights of a target layer.

@description
This wrapper controls the Lipschitz constant of the weights of a layer by
constraining their spectral norm, which can stabilize the training of GANs.

# Examples
Wrap `layer_conv_2d`:
```{r}
x <- random_uniform(c(1, 10, 10, 1))
conv2d <- layer_spectral_normalization(
  layer = layer_conv_2d(filters = 2, kernel_size = 2)
)
y <- conv2d(x)
y$shape
```

Wrap `layer_Dense`:
```{r}
x <- random_uniform(c(1, 10, 10, 1))
dense <- layer_spectral_normalization(layer = layer_dense(units = 10))
y <- dense(x)
y$shape
```

# Reference
- [Spectral Normalization for GAN](https://arxiv.org/abs/1802.05957).

@param layer
A `Layer` instance that
has either a `kernel` (e.g. `layer_conv_2d`, `layer_dense`...)
or an `embeddings` attribute (`Embedding` layer).

@param power_iterations
int, the number of iterations during normalization.

@param ...
Base wrapper keyword arguments.

@param object
Object to compose the layer with. A tensor, array, or sequential model.

@export
@family spectral normalization layers
@family normalization layers
@family layers
@seealso
+ <https://www.tensorflow.org/api_docs/python/tf/keras/layers/SpectralNormalization>

